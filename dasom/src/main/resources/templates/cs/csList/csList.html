<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/csList.css">
    <title>봉사페이지</title>
</head>

<body>
    <main>
        <!-- 상단 이미지 배너 -->
        <section class="top-banner margin-auto">
            <div class="banner-img">
                <img class="banner-img-img" src="/img/가로사진.jpg" alt="">
            </div>
            <div class="banner-text flex-center">봉사단 모집</div>
        </section>

        <!-- 진행중인캠페인/종료된캠페인 -->
        <section class="campaign-open-close margin-auto">
            <div class="campaign open">
                <div class="campaign-text" id="campaign-ongoing">진행중캠페인</div>
                <hr id="hr-on">
            </div>
            <div class="campaign close">
                <div class="campaign-text" id="campaign-end">종료된캠페인</div>
                <hr id="hr-end">
            </div>
        </section>

        <section class="board-items">
            <!-- 게시글 리스트 -->

               <!-- 게시글 끝 -->

        </section>
    </main>

    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
            crossorigin="anonymous"></script>
    <script>

        //모집진행 & 모집완료 버튼 결정하는 변수. 초기값:모집진행
        let stat = '모집진행';
        console.log(stat);
        //페이지 진입시 비동기 게시판 구성
        myModule('0',stat, showResult);

        //비동기식 게시판 리스트 출력 함수
        function myModule(status,stat,callback) {
            $.ajax({
                url: `/csRest/${status}`,
                type: 'get',
                dataType: 'json',
                success: function (result) {
                        console.log(result);
                        console.log(stat);
                    if (callback) {
                        callback(result,stat);
                    }
                },
                error: function (a, b, c) {
                    console.log(c);
                }
            });
        }

        //html에 들어갈 양식
        function showResult(result,stat) {
            let text = '';
            result.forEach(r => {

                text += `
                <a href="/cs/detail?csNum=${r.csWriteNumber}" class="main-va-tag">
                <div class="main-va-list">
                    <div class="main-va-text">봉사지원</div>
                    <div class="main-va-content">[모집]${r.csWriteTitle}</div>
                    <div class="main-va-at">
                        <div class="main-va-attext">모집인원</div>
                        <div class="main-va-atcnt">${r.csWriteCount}명</div>
                    </div>
                    <div class="main-va-date">
                        <div class="main-va-datetext">활동기간</div>
                        <div class="main-va-datedetail">${r.csWriteActStart} ~ ${r.csWriteActEnd}</div>
                    </div>
                </div>
                <div class="main-va-status">${stat}</div>
            </a>
                    `;
            });
            $('.board-items').html(text);
        }

        //진행중 캠페인 클릭
        $('#campaign-ongoing').on('click',function (){
            stat = '모집진행';
            //버튼 css 조정
            document.getElementById("hr-end").style.display="none";
            document.getElementById("hr-end").style.color="black";
            document.getElementById("hr-on").style.display="";
            document.getElementById("campaign-ongoing").style.color="#39b54a";
            document.getElementById("campaign-end").style.color="black";

            myModule('0',stat, showResult);
        });

        //종료된 캠페인 클릭
        $('#campaign-end').on('click',function (){
                stat = '모집완료';
            console.log(stat);
            console.log("종료된 캠페인!!");
            //버튼 css 조정
            document.getElementById("hr-on").style.display="none";
            document.getElementById("hr-on").style.color="black";
            document.getElementById("hr-end").style.display="block";
            document.getElementById("campaign-ongoing").style.color="black";
            document.getElementById("campaign-end").style.color="#39b54a";

            myModule('1',stat,showResult);
        });

    </script>


</body>

</html>